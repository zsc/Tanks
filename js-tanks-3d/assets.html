<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tank Battle - Audio Assets</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #0f0;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            color: #0f0;
            text-shadow: 0 0 10px #0f0;
            border-bottom: 2px solid #0f0;
            padding-bottom: 10px;
        }
        h2 {
            color: #0a0;
            margin-top: 30px;
        }
        .audio-container {
            background: #2a2a2a;
            border: 1px solid #0f0;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .audio-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #0f0;
        }
        audio {
            width: 100%;
            margin: 5px 0;
        }
        .abc-notation {
            background: #333;
            padding: 10px;
            border-radius: 3px;
            margin: 10px 0;
            font-size: 12px;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        button {
            background: #0f0;
            color: #000;
            border: none;
            padding: 5px 15px;
            cursor: pointer;
            font-family: inherit;
            margin: 5px;
            border-radius: 3px;
        }
        button:hover {
            background: #0a0;
        }
        .controls {
            margin: 20px 0;
            padding: 15px;
            background: #2a2a2a;
            border: 1px solid #0f0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>üéÆ Tank Battle - Multi-Track Audio Assets üéµ</h1>
    <p style="color: #0a0; margin: 10px 0;">Enhanced with chord progressions, bass lines, and timpani percussion!</p>
    
    <div class="controls">
        <h2>Master Controls</h2>
        <button onclick="playAll()">‚ñ∂Ô∏è Play All</button>
        <button onclick="stopAll()">‚èπÔ∏è Stop All</button>
        <button onclick="setVolume(0.5)">üîâ 50% Volume</button>
        <button onclick="setVolume(1.0)">üîä 100% Volume</button>
    </div>

    <h2>Game Music Tracks</h2>

    <div class="audio-container">
        <div class="audio-title">üé∫ Title Theme</div>
        <audio id="title_theme" controls>
            <source src="audio/title_theme.ogg?v=1756544103" type="audio/ogg">
            Your browser does not support the audio element.
        </audio>
        <button onclick="toggleABC('title_abc')">Show/Hide ABC Notation</button>
        <div id="title_abc" class="abc-notation" style="display:none;">
[Multi-Track Arrangement]
- Voice 1: Main Melody (Heroic march theme)
- Voice 2: Harmony/Chords (C, F, G progressions)
- Voice 3: Bass Line (Walking bass pattern)
- Voice 4: Timpani (Military percussion)

Tempo: 140 BPM | Key: C Major
        </div>
    </div>

    <div class="audio-container">
        <div class="audio-title">‚öîÔ∏è Battle Theme</div>
        <audio id="battle_theme" controls>
            <source src="audio/battle_theme.ogg?v=1756544103" type="audio/ogg">
            Your browser does not support the audio element.
        </audio>
        <button onclick="toggleABC('battle_abc')">Show/Hide ABC Notation</button>
        <div id="battle_abc" class="abc-notation" style="display:none;">
[Multi-Track Arrangement]
- Voice 1: Main Melody (Fast-paced action theme)
- Voice 2: Power Chords (Dm, Gm, F, C progressions)
- Voice 3: Driving Bass Line (Repetitive, intense pattern)
- Voice 4: War Drums (Timpani with aggressive rhythm)

Tempo: 160 BPM | Key: D Minor
        </div>
    </div>

    <div class="audio-container">
        <div class="audio-title">üèÜ Victory Theme</div>
        <audio id="victory_theme" controls>
            <source src="audio/victory_theme.ogg?v=1756544103" type="audio/ogg">
            Your browser does not support the audio element.
        </audio>
        <button onclick="toggleABC('victory_abc')">Show/Hide ABC Notation</button>
        <div id="victory_abc" class="abc-notation" style="display:none;">
[Multi-Track Arrangement]
- Voice 1: Main Melody (Triumphant fanfare)
- Voice 2: Triumphant Harmonies (G, D, C, Am chords)
- Voice 3: Celebratory Bass (Ascending patterns)
- Voice 4: Victory Rolls (Timpani with dramatic flourishes)

Tempo: 120 BPM | Key: G Major
        </div>
    </div>

    <div class="audio-container">
        <div class="audio-title">üíÄ Game Over Theme</div>
        <audio id="game_over_theme" controls>
            <source src="audio/game_over_theme.ogg?v=1756544103" type="audio/ogg">
            Your browser does not support the audio element.
        </audio>
        <button onclick="toggleABC('gameover_abc')">Show/Hide ABC Notation</button>
        <div id="gameover_abc" class="abc-notation" style="display:none;">
[Multi-Track Arrangement]
- Voice 1: Main Melody (Slow, mournful theme)
- Voice 2: Mournful Harmonies (Am, Dm, Em, G chords)
- Voice 3: Deep Bass Line (Slow, descending pattern)
- Voice 4: Funeral Drums (Sparse timpani hits)

Tempo: 80 BPM | Key: A Minor
        </div>
    </div>

    <div class="audio-container">
        <div class="audio-title">‚≠ê Powerup Jingle</div>
        <audio id="powerup_jingle" controls>
            <source src="audio/powerup_jingle.ogg?v=1756544103" type="audio/ogg">
            Your browser does not support the audio element.
        </audio>
        <button onclick="toggleABC('powerup_abc')">Show/Hide ABC Notation</button>
        <div id="powerup_abc" class="abc-notation" style="display:none;">
[Multi-Track Arrangement]
- Voice 1: Main Melody (Quick ascending arpeggio)
- Voice 2: Bright Harmonies (C major chord progression)
- Voice 3: Rising Bass (C to high C octave jump)
- Voice 4: Quick Hits (Timpani accents)

Tempo: 180 BPM | Key: C Major
        </div>
    </div>

    <h2>Sound Effects</h2>

    <div class="audio-container">
        <div class="audio-title">üí• Cannon Fire (WAV)</div>
        <audio id="bullet_fire" controls>
            <source src="audio/bullet_fire.wav" type="audio/wav">
            Your browser does not support the audio element.
        </audio>
        <button onclick="toggleABC('bullet_fire_abc')">Show/Hide ABC Notation</button>
        <div id="bullet_fire_abc" class="abc-notation" style="display:none;">
[Crisp Cannon Fire - Multi-Track Arrangement]
- Voice 1: Main cannon blast with powerful harmonics
- Voice 2: Deep cannon boom with extended sub-bass
- Voice 3: Mid-range resonance for barrel echo
- Voice 4: Sharp metallic ring with crisp attack
- Voice 5: Heavy percussion with cannon mechanism
- Voice 6: Smoke and pressure release

Tempo: 220 BPM | Key: C Major
Duration: ~0.3 seconds
Features: Crisp cannon synthesis with deep boom, barrel resonance, metallic overtones, mechanism clunk, pressure release, and shell ejection ring
        </div>
    </div>

    <div class="audio-container">
        <div class="audio-title">üí• Bullet Hit (WAV)</div>
        <audio id="bullet_hit" controls>
            <source src="audio/bullet_hit.wav" type="audio/wav">
            Your browser does not support the audio element.
        </audio>
        <button onclick="toggleABC('bullet_hit_abc')">Show/Hide ABC Notation</button>
        <div id="bullet_hit_abc" class="abc-notation" style="display:none;">
[Enhanced Multi-Track Arrangement]
- Voice 1: Explosive impact with harmonic cascade
- Voice 2: Deep explosion rumble with sub-bass
- Voice 3: Mid-range explosive burst
- Voice 4: High frequency shrapnel and debris
- Voice 5: Metallic crash with reverb
- Voice 6: Sub-bass aftershock

Tempo: 240 BPM | Key: C Major
Duration: ~0.5 seconds
Features: Multi-stage explosion with pitch sweep, sub-bass rumble, harmonic layers, debris noise, aftershock thump, and soft clipping
        </div>
    </div>

    <div class="audio-container">
        <div class="audio-title">üî• Tank Explosion (WAV)</div>
        <audio id="tank_explode" controls>
            <source src="audio/tank_explode.wav" type="audio/wav">
            Your browser does not support the audio element.
        </audio>
        <button onclick="toggleABC('tank_explode_abc')">Show/Hide Description</button>
        <div id="tank_explode_abc" class="abc-notation" style="display:none;">
[Dedicated Tank Destruction Sound]
This powerful explosion sound is specifically designed for tank destruction.
Features a more dramatic and extended explosion compared to bullet hits:
- Massive initial blast
- Deep rumbling explosion with extended sustain
- Multiple layers of metallic debris
- Secondary explosions and cascading effects
- Heavy sub-bass that shakes the battlefield
- Extended reverb tail for epic feel

The dedicated tank_explode.wav provides a more impactful experience
when tanks are destroyed, distinguishing it from regular bullet impacts.
The 3D positioning system automatically adjusts volume and panning based on distance.
        </div>
    </div>

    <h2>3D Positional Audio Demo</h2>
    <div class="audio-container">
        <h3>Test 3D Audio Positioning</h3>
        <div style="margin: 20px 0;">
            <button onclick="test3DAudio('left')">‚ñ∂Ô∏è Fire Left</button>
            <button onclick="test3DAudio('center')">‚ñ∂Ô∏è Fire Center</button>
            <button onclick="test3DAudio('right')">‚ñ∂Ô∏è Fire Right</button>
            <button onclick="test3DAudio('explode')">üí• Tank Explode</button>
            <button onclick="test3DAudio('far')">‚ñ∂Ô∏è Hit Far</button>
            <button onclick="test3DAudio('sequence')">üéµ Play Sequence</button>
        </div>
        <div id="3d-audio-info" style="color: #0a0; margin-top: 10px;">
            Click buttons to test 3D audio positioning with combat sounds
        </div>
    </div>

    <h2>Usage in Game</h2>
    <div class="audio-container">
        <pre style="color: #0f0;">
// Example JavaScript usage:
const audioManager = {
    tracks: {
        // Background music (OGG for better compression)
        title: new Audio('audio/title_theme.ogg'),
        battle: new Audio('audio/battle_theme.ogg'),
        victory: new Audio('audio/victory_theme.ogg'),
        gameOver: new Audio('audio/game_over_theme.ogg'),
        powerup: new Audio('audio/powerup_jingle.ogg'),
        
        // Sound effects (WAV for better quality and lower latency)
        bulletFire: new Audio('audio/bullet_fire.wav'),
        bulletHit: new Audio('audio/bullet_hit.wav'),
        tankExplode: new Audio('audio/tank_explode.wav')  // Dedicated tank explosion sound
    },
    
    play(trackName, loop = false) {
        const track = this.tracks[trackName];
        if (track) {
            track.loop = loop;
            track.play();
        }
    },
    
    stop(trackName) {
        const track = this.tracks[trackName];
        if (track) {
            track.pause();
            track.currentTime = 0;
        }
    }
};

// Play title music on menu
audioManager.play('title', true);

// Play battle music during game
audioManager.play('battle', true);

// Play powerup sound effect
audioManager.play('powerup', false);

// 3D Positional Audio Example
audioManager.play3D('bulletFire', 
    {x: 10, z: 5},      // Sound position
    {x: 0, z: 0},       // Listener position
    {
        volume: 0.8,
        maxDistance: 20,
        refDistance: 2
    }
);

// Distance-based volume calculation
// volume = refDistance / distance (when distance > refDistance)
// Stereo panning based on angle between listener and source
        </pre>
    </div>

    <script>
        function toggleABC(id) {
            const elem = document.getElementById(id);
            elem.style.display = elem.style.display === 'none' ? 'block' : 'none';
        }

        function playAll() {
            const audios = document.querySelectorAll('audio');
            let delay = 0;
            audios.forEach((audio, index) => {
                setTimeout(() => {
                    audio.play();
                }, delay);
                delay += 3000; // 3 second delay between tracks
            });
        }

        function stopAll() {
            const audios = document.querySelectorAll('audio');
            audios.forEach(audio => {
                audio.pause();
                audio.currentTime = 0;
            });
        }

        function setVolume(level) {
            const audios = document.querySelectorAll('audio');
            audios.forEach(audio => {
                audio.volume = level;
            });
        }

        // Set initial volume
        window.addEventListener('DOMContentLoaded', () => {
            setVolume(0.5);
            
            // Initialize Web Audio API for 3D audio demo
            window.audioContext = null;
            try {
                window.AudioContext = window.AudioContext || window.webkitAudioContext;
                window.audioContext = new AudioContext();
            } catch(e) {
                console.warn('Web Audio API not supported');
            }
        });
        
        // Audio buffers for 3D demo
        window.audioBuffers = {};
        
        // Load audio files as buffers for 3D audio demo
        async function loadAudioBuffer(url, name) {
            if (!window.audioContext) return;
            
            try {
                const response = await fetch(url);
                const arrayBuffer = await response.arrayBuffer();
                const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
                window.audioBuffers[name] = audioBuffer;
            } catch (e) {
                console.warn('Failed to load audio buffer:', name, e);
            }
        }
        
        // Load audio buffers on page load
        window.addEventListener('DOMContentLoaded', async () => {
            if (window.audioContext) {
                await loadAudioBuffer('audio/bullet_fire.wav', 'bulletFire');
                await loadAudioBuffer('audio/bullet_hit.wav', 'bulletHit');
                await loadAudioBuffer('audio/tank_explode.wav', 'tankExplode');
            }
        });
        
        // 3D Audio Testing Functions
        function test3DAudio(position) {
            const info = document.getElementById('3d-audio-info');
            
            if (!window.audioContext) {
                info.textContent = 'Web Audio API not supported - playing without positioning';
                document.getElementById('bullet_fire').play();
                return;
            }
            
            // Resume audio context if suspended
            if (audioContext.state === 'suspended') {
                audioContext.resume().then(() => {
                    // Load buffers if not already loaded
                    if (!window.audioBuffers.bulletFire) {
                        loadAudioBuffer('audio/bullet_fire.wav', 'bulletFire');
                        loadAudioBuffer('audio/bullet_hit.wav', 'bulletHit');
                        loadAudioBuffer('audio/tank_explode.wav', 'tankExplode');
                        info.textContent = 'Loading audio buffers... Please try again in a moment.';
                        return;
                    }
                });
            }
            
            if (!window.audioBuffers.bulletFire || !window.audioBuffers.bulletHit || !window.audioBuffers.tankExplode) {
                info.textContent = 'Audio buffers not loaded yet. Please wait...';
                // Try to load them now
                Promise.all([
                    loadAudioBuffer('audio/bullet_fire.wav', 'bulletFire'),
                    loadAudioBuffer('audio/bullet_hit.wav', 'bulletHit'),
                    loadAudioBuffer('audio/tank_explode.wav', 'tankExplode')
                ]).then(() => {
                    info.textContent = 'Audio loaded! Try clicking again.';
                });
                return;
            }
            
            switch(position) {
                case 'left':
                    play3DSound('bulletFire', -1, 1.0);
                    info.innerHTML = 'üîä Playing LEFT - Pan: -1.0, Volume: 100%';
                    break;
                case 'right':
                    play3DSound('bulletFire', 1, 1.0);
                    info.innerHTML = 'üîä Playing RIGHT - Pan: +1.0, Volume: 100%';
                    break;
                case 'center':
                    play3DSound('bulletFire', 0, 1.0);
                    info.innerHTML = 'üîä Playing CENTER - Pan: 0.0, Volume: 100%';
                    break;
                case 'explode':
                    play3DSound('tankExplode', 0, 1.0);
                    info.innerHTML = 'üí• Tank EXPLOSION - Pan: 0.0, Volume: 100%';
                    break;
                case 'far':
                    play3DSound('bulletHit', 0, 0.3);
                    info.innerHTML = 'üîä Playing FAR (Hit sound) - Pan: 0.0, Volume: 30%';
                    break;
                case 'sequence':
                    info.innerHTML = 'üéµ Playing sequence: Fire Left ‚Üí Center ‚Üí Right ‚Üí Tank Explosion';
                    play3DSound('bulletFire', -1, 1.0);
                    setTimeout(() => play3DSound('bulletFire', 0, 1.0), 500);
                    setTimeout(() => play3DSound('bulletFire', 1, 1.0), 1000);
                    setTimeout(() => play3DSound('tankExplode', 0, 1.0), 1500);
                    break;
            }
        }
        
        function play3DSound(bufferName, pan, volume) {
            if (!window.audioContext || !window.audioBuffers[bufferName]) {
                console.warn('Audio not ready:', bufferName);
                return;
            }
            
            try {
                // Create a new buffer source for each playback
                const source = audioContext.createBufferSource();
                source.buffer = window.audioBuffers[bufferName];
                
                // Create gain node for volume control
                const gainNode = audioContext.createGain();
                gainNode.gain.value = volume;
                
                // Create stereo panner for positioning
                const panner = audioContext.createStereoPanner();
                panner.pan.value = pan;
                
                // Connect the audio graph
                source.connect(gainNode);
                gainNode.connect(panner);
                panner.connect(audioContext.destination);
                
                // Start playback
                source.start(0);
                
                // Clean up when done (buffer sources are one-time use)
                source.onended = () => {
                    source.disconnect();
                    gainNode.disconnect();
                    panner.disconnect();
                };
            } catch(e) {
                console.error('3D audio playback error:', e);
            }
        }
    </script>
</body>
</html>